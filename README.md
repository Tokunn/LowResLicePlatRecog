# LowResLicePlatRecog
低解像度のナンバープレート（を模擬した画像）に書かれた数字を検出  

## 概要
ドラマ科捜研の女で有名な「そこ拡大鮮明化」できるアプリケーション    
  
監視カメラに映った数ドット分しかないナンバープレートを復元できる"謎技術"  
昔から疑問に思っていたが、ディープラーニングを使用して実現できるのではないかと思い実装  

実際にナンバープレートの画像を大量に集めることは難しいため、ナンバープレートに似た画像を自動で生成して学習に使用  
必ず正面から写るとは限らないのでデータ拡張でシフト・回転
  
## 機能
自動で生成した低解像度のナンバープレート画像を選択すると、システムがもともと書かれていた数字を推論して出力

## 動作環境
- Ubuntu 20.04 (WSL)
- Python 3.8.5
- PHP 7.4.3
- ipython                7.13.0              
- Keras                  2.4.3               
- Keras-Preprocessing    1.1.2               
- matplotlib             3.3.3               
- notebook               6.0.3               
- numpy                  1.19.4              
- pandas                 1.1.5               
- Pillow                 8.0.1               
- scikit-learn           0.24.0              
- scipy                  1.5.4               
- tensorflow             2.4.0               

## 動作例
./LowResLicePlatRecog.ipyngを参照

## 使い方
- fonts-japanese-gothicを/usr/share/fonts/truetype/に保存（ほかの日本語フォントでも代用可能）
- jupyter-notebookから./numberimg/make_license_place.ipynbを実行し、学習用データを生成
- jupyter-notebookから./LowResLicePlatRecong.ipynbを実行し、学習・weightファイルを生成&推論（20分程度）

## 使い方2
ブラウザから試す方法
- ./frontend/phpへ移動
- ```localhost -S localhost:8000```
- ブラウザからアクセス
- Generateボタンをクリック
- 推論させてみたい画像をクリック

## モデル
```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
_________________________________________________________________
conv2d (Conv2D)              (None, 64, 64, 32)        896       
_________________________________________________________________
activation (Activation)      (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 62, 62, 32)        9248      
_________________________________________________________________
activation_1 (Activation)    (None, 62, 62, 32)        0         
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 31, 31, 32)        0         
_________________________________________________________________
dropout (Dropout)            (None, 31, 31, 32)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 31, 31, 32)        9248      
_________________________________________________________________
activation_2 (Activation)    (None, 31, 31, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 29, 29, 32)        9248      
_________________________________________________________________
activation_3 (Activation)    (None, 29, 29, 32)        0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 14, 14, 32)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 14, 14, 32)        0         
_________________________________________________________________
flatten (Flatten)            (None, 6272)              0         
_________________________________________________________________
dense (Dense)                (None, 512)               3211776   
_________________________________________________________________
activation_4 (Activation)    (None, 512)               0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 512)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 99)                50787     
_________________________________________________________________
activation_5 (Activation)    (None, 99)                0         
_________________________________________________________________
Total params: 3,291,203
Trainable params: 3,291,203
Non-trainable params: 0
_________________________________________________________________
```

## 注意
ブラウザから試す場合に入力をパースしていなためOSコマンドインジェクション

## 課題
ナンバープレート全てのパターンを学習させようとした場合に、学習枚数が膨大になってしまう